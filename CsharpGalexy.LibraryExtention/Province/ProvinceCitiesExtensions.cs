using System;
using System.Collections.Generic;
using System.Linq;

public static class ProvinceCitiesExtensions
{
    private static readonly Dictionary<string, string[]> ProvinceCities = new Dictionary<string, string[]>(StringComparer.OrdinalIgnoreCase)
    {
        { "تهران", new[] { "تهران", "کرج", "شهریار", "اسلامشهر", "پاکدشت", "ورامین", "دماوند", "فشم", "رودهن", "فیروزکوه", "قدس", "ملارد", "صباشهر" } },
        { "اصفهان", new[] { "اصفهان", "کاشان", "خمینی‌شهر", "فلاورجان", "نجف‌آباد", "شاهین‌شهر", "مبارکه", "آران و بیدگل", "لنجان", "گلپایگان", "نایین", "اردستان", "شهرضا", "سمیرم", "برخوار" } },
        { "خراسان رضوی", new[] { "مشهد", "سبزوار", "نیشابور", "تربت حیدریه", "قوچان", "تایباد", "چناران", "کاشمر", "فریمان", "بجستان", "خلیل‌آباد", "گناباد", "تربت جام", "باخرز", "رشتخوار" } },
        { "فارس", new[] { "شیراز", "مرودشت", "جهرم", "فسا", "داراب", "لار", "کازرون", "آباده", "نورآباد", "اقلید", "زرین‌دشت", "استهبان", "خرم‌بید", "ممسنی", "لامرد" } },
        { "آذربایجان شرقی", new[] { "تبریز", "مراغه", "مرند", "میانه", "اهر", "شبستر", "سراب", "هشترود", "ورزقان", "عجب‌شیر", "بناب", "کلیبر", "ملکان", "باسمنج" } },
        { "خوزستان", new[] { "اهواز", "دزفول", "آبادان", "خرمشهر", "اندیمشک", "شوش", "شوشتر", "بهبهان", "مسجدسلیمان", "رامهرمز", "ایذه", "هندیجان", "باغ‌ملک", "آغاجاری", "گتوند" } },
        { "البرز", new[] { "کرج", "نظرآباد", "ساوجبلاغ", "طالقان", "فردیس", "اشتهارد", "چهارباغ" } },
        { "قم", new[] { "قم", "قنوات", "سلفچگان", "جعفریه" } },
        { "یزد", new[] { "یزد", "اردکان", "تفت", "میبد", "ابرکوه", "بافق", "مهریز", "اشکذر", "خضرآباد" } },
        { "گیلان", new[] { "رشت", "انزلی", "لاهیجان", "لنگرود", "فومن", "آستارا", "رودسر", "صومعه‌سرا", "رضوانشهر", "آستانه اشرفیه", "شفت", "ماسال", "سیاهکل" } },
        { "آذربایجان غربی", new[] { "ارومیه", "خوی", "میاندوآب", "نقده", "مهاباد", "بوکان", "سلماس", "پیرانشهر", "شاهین‌دژ", "تکاب", "سردشت", "اشنویه", "چهاربرج", "پلدشت" } },
        { "سیستان و بلوچستان", new[] { "زاهدان", "چابهار", "ایرانشهر", "سراوان", "خاش", "نیکشهر", "کنارک", "سرباز", "دلگان", "زابل", "هیرمند", "میرجاوه" } },
        { "کردستان", new[] { "سنندج", "سقز", "بیجار", "قروه", "مریوان", "دیواندره", "کامیاران", "بانه", "دهگلان" } },
        { "خراسان شمالی", new[] { "بجنورد", "شیروان", "اسفراین", "گرمه", "فاروج", "جاجرم", "راز", "مانه و سملقان" } },
        { "مازندران", new[] { "ساری", "بابل", "آمل", "قائم‌شهر", "نکا", "تنکابن", "نور", "چالوس", "رامسر", "بهشهر", "محمودآباد", "فیروزکوه", "کلاردشت" } },
        { "هرمزگان", new[] { "بندرعباس", "میناب", "قشم", "بستک", "رودان", "جاسک", "حاجی‌آباد", "پارسیان", "ابوموسی", "بشاگرد" } },
        { "لرستان", new[] { "خرم‌آباد", "بروجرد", "دورود", "الیگودرز", "ازنا", "کوهدشت", "پلدختر", "نورآباد", "دلفان", "سراب دوره" } },
        { "قزوین", new[] { "قزوین", "آبیک", "البرز", "تاکستان", "محمدیه", "ارداق", "بوئین‌زهرا" } },
        { "همدان", new[] { "همدان", "ملایر", "نهاوند", "تویسرکان", "کبودرآهنگ", "فامنین", "اسدآباد", "رزن", "بهار" } },
        { "کهگیلویه و بویراحمد", new[] { "یاسوج", "دوگنبدان", "دنا", "چرام", "لنده", "باشت", "سی سخت", "پاتاوه" } },
        { "اردبیل", new[] { "اردبیل", "پارس‌آباد", "مشگین‌شهر", "خلخال", "نمین", "نیر", "کوثر", "بیله‌سوار", "گرمی" } },
        { "خراسان جنوبی", new[] { "بیرجند", "قائن", "طبس", "فردوس", "نهبندان", "درمیان", "سربیشه", "خضری", "زهان", "آیسک" } },
        { "زنجان", new[] { "زنجان", "ابهر", "خرمدره", "قیدار", "ایجرود", "سلطانیه", "هیدج", "ماهنشان" } },
        { "سمنان", new[] { "سمنان", "شاهرود", "دامغان", "گرمسار", "مهدی‌شهر", "میامی", "آرادان", "بسطام" } },
        { "ایلام", new[] { "ایلام", "دهلران", "ایوان", "آبدانان", "چرداول", "دره شهر", "مهران", "بدره", "مورموری" } },
        { "گلستان", new[] { "گرگان", "گنبد کاووس", "آزادشهر", "علی‌آباد کتول", "آق‌قلا", "مینودشت", "کلاله", "ترکمن", "رامیان", "فاضل‌آباد", "گالیکش" } },
        { "بوشهر", new[] { "بوشهر", "دشتستان", "دشتی", "کنگان", "گناوه", "تنگستان", "جم", "دیر", "عسلویه", "ریز", "آباد" } },
        { "مرکزی", new[] { "اراک", "ساوه", "خمین", "محلات", "دلیجان", "شازند", "تفرش", "آشتیان", "خنداب", "فراهان", "کمیجان" } },
        { "چهارمحال و بختیاری", new[] { "شهرکرد", "بروجن", "فارسان", "لردگان", "اردل", "سامان", "کیان", "نقنه", "سودجان", "بن" } },
        { "کرمان", new[] { "کرمان", "سیرجان", "رفسنجان", "زرند", "جیرفت", "بم", "بافت", "رودبار", "شهداد", "منوجان", "فهرج", "عنبرآباد", "کوهبنان" } }
    };

    /// <summary>
    /// دریافت لیست شهرهای یک استان
    /// </summary>
    /// <param name="provinceName">نام استان</param>
    /// <returns>آرایه‌ای از نام شهرها یا null اگر استان یافت نشد</returns>
    public static string[]? GetProvinceCities(this string provinceName)
    {
        if (string.IsNullOrWhiteSpace(provinceName))
            throw new ArgumentException("نام استان نمی‌تواند خالی باشد.", nameof(provinceName));

        return ProvinceCities.TryGetValue(provinceName.Trim(), out var cities) ? cities : null;
    }
}